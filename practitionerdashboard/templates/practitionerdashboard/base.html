<!DOCTYPE html>
{% load user_info_tags %}
{% load static %}
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'assets/img/favicon.ico' %}">
    <title>{% block title %}Practitioner Dashboard{% endblock %}</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'doctor-blue': '#1e40af',
                        'doctor-light-blue': '#dbeafe',
                        'doctor-dark-blue': '#1e3a8a',
                        'doctor-green': '#059669',
                        'doctor-light-green': '#d1fae5',
                        'doctor-teal': '#0d9488',
                        'doctor-gray': '#f8fafc',
                        'doctor-dark-gray': '#64748b',
                        'doctor-red': '#dc2626',
                        'doctor-orange': '#ea580c',
                        'doctor-purple': '#7c3aed',
                        'doctor-pink': '#ec4899',
                        'doctor-indigo': '#4f46e5'
                    },
                    fontFamily: {
                        'doctor': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'slide-in': 'slideIn 0.3s ease-out',
                        'fade-in': 'fadeIn 0.3s ease-out',
                        'bounce-gentle': 'bounceGentle 2s infinite',
                    }
                }
            }
        }
    </script>

    {% block extra_css %}{% endblock %}
    
    <style>
        /* Modern Practitioner Dashboard Styles */
        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #dbeafe 100%);
        }
        
        /* Sidebar Animations */
        .sidebar-enter {
            transform: translateX(-100%);
        }
        
        .sidebar-enter-active {
            transform: translateX(0);
            transition: transform 0.3s ease-out;
        }
        
        .sidebar-exit {
            transform: translateX(0);
        }
        
        .sidebar-exit-active {
            transform: translateX(-100%);
            transition: transform 0.3s ease-out;
        }
        
        /* Card Hover Effects */
        .doctor-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .doctor-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(30, 64, 175, 0.15);
        }
        
        /* Medical Pulse Animation */
        .medical-pulse {
            animation: medicalPulse 2s infinite;
        }
        
        @keyframes medicalPulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(30, 64, 175, 0.4);
            }
            50% {
                box-shadow: 0 0 0 15px rgba(30, 64, 175, 0);
            }
        }
        
        /* Notification Badge */
        .notification-badge {
            animation: notificationBounce 2s infinite;
        }
        
        @keyframes notificationBounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-3px);
            }
            60% {
                transform: translateY(-1px);
            }
        }
        
        /* Alert Bell Specific Styles */
        .alert-bell-active {
            animation: bellRing 0.5s ease-in-out;
        }
        
        @keyframes bellRing {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(15deg); }
            75% { transform: rotate(-15deg); }
        }
        
        /* Pending Appointments Dropdown */
        .pending-appointment-item:hover {
            background: linear-gradient(135deg, #f8fafc 0%, #dbeafe 100%);
        }
        
        .quick-action-btn {
            transition: all 0.2s ease;
        }
        
        .quick-action-btn:hover {
            transform: scale(1.1);
        }
        
        /* Notification Panel Animations */
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* Smooth Transitions */
        .smooth-transition {
            transition: all 0.3s ease;
        }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #1e40af;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #1e3a8a;
        }
        
        /* Responsive Design Improvements */
        @media (max-width: 768px) {
            .sidebar-mobile-hidden {
                display: none;
            }
            
            /* Adjust header padding on mobile */
            header {
                padding: 0.75rem 1rem !important;
            }
            
            /* Make main content responsive */
            main {
                padding: 1rem !important;
            }
            
            /* Responsive cards */
            .doctor-card {
                margin-bottom: 1rem;
            }
            
            /* Mobile-friendly buttons */
            .mobile-btn {
                padding: 0.5rem;
                min-width: 44px;
                min-height: 44px;
            }
        }
        
        @media (max-width: 640px) {
            /* Extra small screens */
            .text-responsive {
                font-size: 0.875rem;
            }
            
            /* Hide less important elements on very small screens */
            .sm-hidden {
                display: none;
            }
        }
        
        /* Language Dropdown Specific Styles */
        #languageDropdown {
            z-index: 9999 !important;
            position: absolute !important;
        }
        
        /* Ensure language selector container has proper positioning */
        .language-selector-container {
            position: relative;
            z-index: 1000;
        }
        
        /* RTL Support for Language System */
        [dir="rtl"] {
            text-align: right;
        }
        
        [dir="rtl"] .flex {
            flex-direction: row-reverse;
        }
        
        [dir="rtl"] .space-x-3 > * + * {
            margin-left: 0;
            margin-right: 0.75rem;
        }
        
        [dir="rtl"] .space-x-4 > * + * {
            margin-left: 0;
            margin-right: 1rem;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100px);
            }
        }
    </style>
</head>

<body class="bg-gradient-to-br from-doctor-gray to-doctor-light-blue min-h-screen font-doctor">
    <!-- Modern Practitioner Dashboard Layout -->
    <div class="flex h-screen overflow-hidden">
        
        <!-- Modern Sidebar -->
        <div id="sidebar" class="w-64 bg-gradient-to-b from-doctor-blue to-doctor-dark-blue shadow-2xl transform transition-transform duration-300 ease-in-out lg:translate-x-0 -translate-x-full fixed lg:relative z-40 h-full flex flex-col">
            <!-- Sidebar Header -->
            <div class="p-6 border-b border-white/10 flex-shrink-0">
                <div class="flex items-center space-x-3">
                    <img src="{% static 'MedicalSiteLogo.svg' %}" alt="Medical Platform" class="h-10 w-10">
                    <div>
                        <h2 class="text-white font-bold text-lg">Doctor Portal</h2>
                        <p class="text-white/70 text-sm">Healthcare Dashboard</p>
                    </div>
                </div>
            </div>

            <!-- Navigation Menu -->
            <nav class="flex-1 mt-6 px-4 space-y-2 custom-scrollbar overflow-y-auto">
                <div class="pb-20">
                <a href="{% url 'practitionerdashboard:dashboard' %}" class="flex items-center space-x-3 px-4 py-3 text-white/90 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200 {% if request.resolver_match.url_name == 'dashboard' %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-tachometer-alt text-lg"></i>
                    <span class="font-medium" data-translate="Dashboard">Dashboard</span>
                </a>
                
                <a href="{% url 'practitioner_dashboard:practitioner_profile' %}" class="flex items-center space-x-3 px-4 py-3 text-white/90 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200 {% if request.resolver_match.url_name == 'practitioner_profile' %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-user-md text-lg"></i>
                    <span class="font-medium" data-translate="Profile">Profile</span>
                </a>
                
                <a href="{% url 'practitionerdashboard:mypatient' %}" class="flex items-center space-x-3 px-4 py-3 text-white/90 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200 {% if request.resolver_match.url_name == 'mypatient' %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-users text-lg"></i>
                    <span class="font-medium" data-translate="My Patients">My Patients</span>
                </a>
                
                <a href="{% url 'practitionerdashboard:schedule_timming' %}" class="flex items-center space-x-3 px-4 py-3 text-white/90 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200 {% if request.resolver_match.url_name == 'schedule_timming' %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-clock text-lg"></i>
                    <span class="font-medium" data-translate="Schedule">Schedule Timings</span>
                </a>
                
                <a href="{% url 'practitioner_dashboard:accepted_appointments' %}" class="flex items-center space-x-3 px-4 py-3 text-white/90 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200 {% if request.resolver_match.url_name == 'accepted_appointments' %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-calendar-check text-lg"></i>
                    <span class="font-medium" data-translate="Appointments">Appointments</span>
                </a>
                
                <a href="{% url 'practitionerdashboard:cancellation_completion' %}" class="flex items-center space-x-3 px-4 py-3 text-white/90 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200 {% if request.resolver_match.url_name == 'cancellation_completion' %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-times-circle text-lg"></i>
                    <span class="font-medium" data-translate="Cancellation & Completion">Cancellation & Completion</span>
                </a>
                
                <a href="{% url 'practitionerdashboard:reviews' %}" class="flex items-center space-x-3 px-4 py-3 text-white/90 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200 {% if request.resolver_match.url_name == 'reviews' %}bg-white/20 text-white{% endif %}">
                    <i class="fas fa-star text-lg"></i>
                    <span class="font-medium" data-translate="Reviews">Reviews</span>
                    <span class="ml-auto bg-doctor-green text-white text-xs px-2 py-1 rounded-full notification-badge">
                        {% review_count_from_session request %}
                    </span>
                </a>
                
                <!-- <a href="{% url 'chat:chat_list' %}" class="flex items-center space-x-3 px-4 py-3 text-white/90 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200">
                    <i class="fas fa-comments text-lg"></i>
                    <span class="font-medium">Chat</span>
                    <span class="ml-auto bg-doctor-green text-white text-xs px-2 py-1 rounded-full notification-badge">5</span>
                </a> -->
                </div>
            </nav>
        </div>

        <!-- Main Content Area -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Modern Header -->
            <header class="bg-white/80 backdrop-blur-lg shadow-sm border-b border-gray-200/50 px-4 lg:px-6 py-4">
                <div class="flex items-center justify-between">
                    <!-- Mobile Menu Button -->
                    <button onclick="toggleSidebar()" class="lg:hidden p-2 rounded-lg text-doctor-blue hover:bg-doctor-light-blue transition-colors">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    
                    <!-- Search Bar -->
                    <div class="flex-1 max-w-2xl mx-2 sm:mx-4 hidden sm:block">
                        <div class="relative">
                            <input type="text" 
                                   class="w-full px-4 py-2 pl-10 pr-4 bg-white/70 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-doctor-blue/50 focus:border-doctor-blue transition-all duration-200" 
                                   placeholder="Search patients, appointments..." 
                                   data-translate="Search">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                    </div>
                    
                    <!-- User Profile -->
                    <div class="flex items-center space-x-2 sm:space-x-4">
                        <!-- Language Selector -->
                        <div class="relative language-selector-container">
                            <button id="languageSelector" class="flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-2 bg-doctor-light-blue hover:bg-doctor-blue/10 rounded-xl transition-all duration-300 text-doctor-blue border border-doctor-blue/20" onclick="toggleLanguageDropdown()">
                                <i class="fas fa-globe text-sm"></i>
                                <span id="currentLanguage" class="text-sm font-medium hidden md:inline">English</span>
                                <i class="fas fa-chevron-down text-xs transition-transform duration-200" id="languageChevron"></i>
                            </button>
                            
                            <!-- Language Dropdown -->
                            <div id="languageDropdown" class="absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-2xl border border-gray-200 py-2 z-[9999] hidden">
                                <div class="px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wide border-b border-gray-100">Select Language</div>
                                <button onclick="changeLanguage('en', 'English')" class="language-option w-full text-left px-4 py-3 hover:bg-doctor-light-blue text-gray-700 hover:text-doctor-dark-blue transition-colors duration-200 flex items-center space-x-3">
                                    <span class="w-6 h-4 bg-gradient-to-r from-blue-500 to-red-500 rounded-sm flex items-center justify-center text-white text-xs font-bold">EN</span>
                                    <span>English</span>
                                </button>
                                <button onclick="changeLanguage('ur', 'ÿßÿ±ÿØŸà')" class="language-option w-full text-left px-4 py-3 hover:bg-doctor-light-blue text-gray-700 hover:text-doctor-dark-blue transition-colors duration-200 flex items-center space-x-3">
                                    <span class="w-6 h-4 bg-gradient-to-r from-green-500 to-green-600 rounded-sm flex items-center justify-center text-white text-xs font-bold">UR</span>
                                    <span>ÿßÿ±ÿØŸà</span>
                                </button>
                                <button onclick="changeLanguage('ar', 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©')" class="language-option w-full text-left px-4 py-3 hover:bg-doctor-light-blue text-gray-700 hover:text-doctor-dark-blue transition-colors duration-200 flex items-center space-x-3">
                                    <span class="w-6 h-4 bg-gradient-to-r from-green-600 to-green-700 rounded-sm flex items-center justify-center text-white text-xs font-bold">AR</span>
                                    <span>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</span>
                                </button>
                                <button onclick="changeLanguage('hi', '‡§π‡§ø‡§Ç‡§¶‡•Ä')" class="language-option w-full text-left px-4 py-3 hover:bg-doctor-light-blue text-gray-700 hover:text-doctor-dark-blue transition-colors duration-200 flex items-center space-x-3">
                                    <span class="w-6 h-4 bg-gradient-to-r from-orange-500 to-orange-600 rounded-sm flex items-center justify-center text-white text-xs font-bold">HI</span>
                                    <span>‡§π‡§ø‡§Ç‡§¶‡•Ä</span>
                                </button>
                                <button onclick="changeLanguage('es', 'Espa√±ol')" class="language-option w-full text-left px-4 py-3 hover:bg-doctor-light-blue text-gray-700 hover:text-doctor-dark-blue transition-colors duration-200 flex items-center space-x-3">
                                    <span class="w-6 h-4 bg-gradient-to-r from-red-500 to-yellow-500 rounded-sm flex items-center justify-center text-white text-xs font-bold">ES</span>
                                    <span>Espa√±ol</span>
                                </button>
                                <button onclick="changeLanguage('fr', 'Fran√ßais')" class="language-option w-full text-left px-4 py-3 hover:bg-doctor-light-blue text-gray-700 hover:text-doctor-dark-blue transition-colors duration-200 flex items-center space-x-3">
                                    <span class="w-6 h-4 bg-gradient-to-r from-blue-600 to-red-600 rounded-sm flex items-center justify-center text-white text-xs font-bold">FR</span>
                                    <span>Fran√ßais</span>
                                </button>
                                <button onclick="changeLanguage('de', 'Deutsch')" class="language-option w-full text-left px-4 py-3 hover:bg-doctor-light-blue text-gray-700 hover:text-doctor-dark-blue transition-colors duration-200 flex items-center space-x-3">
                                    <span class="w-6 h-4 bg-gradient-to-r from-black to-red-600 rounded-sm flex items-center justify-center text-white text-xs font-bold">DE</span>
                                    <span>Deutsch</span>
                                </button>
                                <button onclick="changeLanguage('zh', '‰∏≠Êñá')" class="language-option w-full text-left px-4 py-3 hover:bg-doctor-light-blue text-gray-700 hover:text-doctor-dark-blue transition-colors duration-200 flex items-center space-x-3">
                                    <span class="w-6 h-4 bg-gradient-to-r from-red-600 to-yellow-500 rounded-sm flex items-center justify-center text-white text-xs font-bold">ZH</span>
                                    <span>‰∏≠Êñá</span>
                                </button>
                            </div>
                        </div>

                        <!-- Alert Bell for Pending Appointments -->
                        <div class="relative hidden sm:block">
                            <button id="alertBell" onclick="togglePendingAppointments()" class="p-2 text-doctor-blue hover:bg-doctor-light-blue rounded-lg transition-colors relative">
                                <i class="fas fa-bell text-lg"></i>
                                <span id="pendingCount" class="absolute -top-1 -right-1 bg-doctor-red text-white text-xs w-5 h-5 rounded-full flex items-center justify-center notification-badge">0</span>
                            </button>
                            
                            <!-- Pending Appointments Dropdown -->
                            <div id="pendingDropdown" class="absolute right-0 top-full mt-2 w-80 bg-white rounded-xl shadow-2xl border border-gray-200 z-[9999] hidden animate-fade-in">
                                <div class="p-4 border-b border-gray-100">
                                    <h3 class="text-lg font-semibold text-doctor-dark-blue flex items-center">
                                        <i class="fas fa-hourglass-half text-doctor-orange mr-2"></i>
                                        Pending Appointments
                                    </h3>
                                </div>
                                <div id="pendingAppointmentsList" class="max-h-96 overflow-y-auto custom-scrollbar">
                                    <!-- Pending appointments will be loaded here -->
                                </div>
                                <div class="p-3 border-t border-gray-100 text-center">
                                    <a href="{% url 'practitionerdashboard:dashboard' %}" class="text-doctor-blue hover:text-doctor-dark-blue text-sm font-medium">
                                        View All Appointments
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chat -->
                        <a href="{% url 'chat:chat_list' %}" class="p-2 text-doctor-blue hover:bg-doctor-light-blue rounded-lg transition-colors relative hidden sm:block">
                            <i class="fas fa-comments text-lg"></i>
                            <span class="absolute -top-1 -right-1 bg-doctor-green text-white text-xs w-5 h-5 rounded-full flex items-center justify-center notification-badge">5</span>
                        </a>
                        
                        <!-- Profile -->
                        <div class="flex items-center space-x-2 sm:space-x-3">
                            <div class="w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-doctor-blue to-doctor-purple rounded-full flex items-center justify-center">
                                <img src="{% get_practitioner_image request %}" 
                                     alt="Profile Picture" 
                                     class="w-8 h-8 sm:w-10 sm:h-10 rounded-full object-cover border-2 border-white shadow-sm">
                            </div>
                            <div class="hidden lg:block">
                                <p class="text-sm font-medium text-doctor-dark-blue">
                                    {% if request.session.practitioner_name %}
                                        Dr. {{ request.session.practitioner_name }}
                                    {% elif request.user.is_authenticated %}
                                        Dr. {{ request.user.name|default:request.user.email }}
                                    {% else %}
                                        Doctor
                                    {% endif %}
                                </p>
                                <p class="text-xs text-doctor-dark-gray">Medical Professional</p>
                            </div>
                        </div>
                        
                        <a href="{% url 'frontend:logout' %}" class="px-2 sm:px-4 py-2 bg-doctor-red text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium" data-translate="Logout">
                            <i class="fas fa-sign-out-alt sm:mr-2"></i><span class="hidden sm:inline">Logout</span>
                        </a>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <main class="flex-1 overflow-y-auto p-4 lg:p-6 custom-scrollbar">
                {% block content %}
                <!-- Page content will be inserted here -->
                {% endblock content %}
            </main>
        </div>
    </div>

    <!-- Mobile Sidebar Overlay -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-30 lg:hidden hidden" onclick="toggleSidebar()"></div>
<script>
// Practitioner Dashboard Language System
const practitionerTranslations = {
    'en': {
        'Dashboard': 'Dashboard',
        'Profile': 'Profile',
        'My Patients': 'My Patients',
        'Schedule': 'Schedule Timings',
        'Appointments': 'Appointments',
        'Cancellation & Completion': 'Cancellation & Completion',
        'Reviews': 'Reviews',
        'Earnings': 'Earnings',
        'Settings': 'Settings',
        'Logout': 'Logout',
        'Search': 'Search patients, appointments...',
        'Consultations': 'Consultations',
        'Medical Records': 'Medical Records'
    },
    'ur': {
        'Dashboard': '⁄à€åÿ¥ ÿ®Ÿàÿ±⁄à',
        'Profile': 'Ÿæÿ±ŸàŸÅÿßÿ¶ŸÑ',
        'My Patients': 'ŸÖ€åÿ±€í ŸÖÿ±€åÿ∂',
        'Schedule': 'ÿ¥€å⁄àŸàŸÑ Ÿπÿßÿ¶ŸÖŸÜ⁄Øÿ≤',
        'Appointments': 'ÿßŸæÿßÿ¶ŸÜŸπŸÖŸÜŸπÿ≥',
        'Cancellation & Completion': 'ŸÖŸÜÿ≥ŸàÿÆ€å ÿßŸàÿ± ÿ™⁄©ŸÖ€åŸÑ',
        'Reviews': 'ÿ¨ÿßÿ¶ÿ≤€í',
        'Earnings': 'ÿ¢ŸÖÿØŸÜ€å',
        'Settings': 'ÿ≥€åŸπŸÜ⁄Øÿ≤',
        'Logout': 'ŸÑÿß⁄Ø ÿ¢ÿ§Ÿπ',
        'Search': 'ŸÖÿ±€åÿ∂ÿå ÿßŸæÿßÿ¶ŸÜŸπŸÖŸÜŸπÿ≥ ÿ™ŸÑÿßÿ¥ ⁄©ÿ±€å⁄∫...',
        'Consultations': 'ŸÖÿ¥ÿßŸàÿ±ÿ™',
        'Medical Records': 'ÿ∑ÿ®€å ÿ±€å⁄©ÿßÿ±⁄àÿ≤'
    },
    'ar': {
        'Dashboard': 'ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ',
        'Profile': 'ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä',
        'My Patients': 'ŸÖÿ±ÿ∂ÿßŸä',
        'Schedule': 'ŸÖŸàÿßÿπŸäÿØ ÿßŸÑÿπŸÖŸÑ',
        'Appointments': 'ÿßŸÑŸÖŸàÿßÿπŸäÿØ',
        'Cancellation & Completion': 'ÿßŸÑÿ•ŸÑÿ∫ÿßÿ° ŸàÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤',
        'Reviews': 'ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿßÿ™',
        'Earnings': 'ÿßŸÑÿ£ÿ±ÿ®ÿßÿ≠',
        'Settings': 'ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™',
        'Logout': 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨',
        'Search': 'ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑŸÖÿ±ÿ∂Ÿâ ŸàÿßŸÑŸÖŸàÿßÿπŸäÿØ...',
        'Consultations': 'ÿßŸÑÿßÿ≥ÿ™ÿ¥ÿßÿ±ÿßÿ™',
        'Medical Records': 'ÿßŸÑÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ∑ÿ®Ÿäÿ©'
    },
    'hi': {
        'Dashboard': '‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°',
        'Profile': '‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤',
        'My Patients': '‡§Æ‡•á‡§∞‡•á ‡§Æ‡§∞‡•Ä‡§ú‡§º',
        'Schedule': '‡§∂‡•á‡§°‡•ç‡§Ø‡•Ç‡§≤ ‡§∏‡§Æ‡§Ø',
        'Appointments': '‡§Ö‡§™‡•â‡§á‡§Ç‡§ü‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∏',
        'Cancellation & Completion': '‡§∞‡§¶‡•ç‡§¶‡•Ä‡§ï‡§∞‡§£ ‡§î‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§§‡§æ',
        'Reviews': '‡§∏‡§Æ‡•Ä‡§ï‡•ç‡§∑‡§æ‡§è‡§Ç',
        'Earnings': '‡§Ü‡§Ø',
        'Settings': '‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏',
        'Logout': '‡§≤‡•â‡§ó‡§Ü‡§â‡§ü',
        'Search': '‡§Æ‡§∞‡•Ä‡§ú‡§º, ‡§Ö‡§™‡•â‡§á‡§Ç‡§ü‡§Æ‡•á‡§Ç‡§ü ‡§ñ‡•ã‡§ú‡•á‡§Ç...',
        'Consultations': '‡§™‡§∞‡§æ‡§Æ‡§∞‡•ç‡§∂',
        'Medical Records': '‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°'
    },
    'es': {
        'Dashboard': 'Panel de Control',
        'Profile': 'Perfil',
        'My Patients': 'Mis Pacientes',
        'Schedule': 'Horarios',
        'Appointments': 'Citas',
        'Cancellation & Completion': 'Cancelaci√≥n y Finalizaci√≥n',
        'Reviews': 'Rese√±as',
        'Earnings': 'Ganancias',
        'Settings': 'Configuraci√≥n',
        'Logout': 'Cerrar Sesi√≥n',
        'Search': 'Buscar pacientes, citas...',
        'Consultations': 'Consultas',
        'Medical Records': 'Registros M√©dicos'
    },
    'fr': {
        'Dashboard': 'Tableau de Bord',
        'Profile': 'Profil',
        'My Patients': 'Mes Patients',
        'Schedule': 'Horaires',
        'Appointments': 'Rendez-vous',
        'Cancellation & Completion': 'Annulation et Ach√®vement',
        'Reviews': 'Avis',
        'Earnings': 'Revenus',
        'Settings': 'Param√®tres',
        'Logout': 'D√©connexion',
        'Search': 'Rechercher patients, rendez-vous...',
        'Consultations': 'Consultations',
        'Medical Records': 'Dossiers M√©dicaux'
    },
    'de': {
        'Dashboard': 'Dashboard',
        'Profile': 'Profil',
        'My Patients': 'Meine Patienten',
        'Schedule': 'Zeitpl√§ne',
        'Appointments': 'Termine',
        'Cancellation & Completion': 'Stornierung und Abschluss',
        'Reviews': 'Bewertungen',
        'Earnings': 'Einnahmen',
        'Settings': 'Einstellungen',
        'Logout': 'Abmelden',
        'Search': 'Patienten, Termine suchen...',
        'Consultations': 'Beratungen',
        'Medical Records': 'Krankenakten'
    },
    'zh': {
        'Dashboard': '‰ª™Ë°®Êùø',
        'Profile': '‰∏™‰∫∫ËµÑÊñô',
        'My Patients': 'ÊàëÁöÑÊÇ£ËÄÖ',
        'Schedule': 'Êó∂Èó¥ÂÆâÊéí',
        'Appointments': 'È¢ÑÁ∫¶',
        'Cancellation & Completion': 'ÂèñÊ∂àÂíåÂÆåÊàê',
        'Reviews': 'ËØÑËÆ∫',
        'Earnings': 'Êî∂ÂÖ•',
        'Settings': 'ËÆæÁΩÆ',
        'Logout': 'ÁôªÂá∫',
        'Search': 'ÊêúÁ¥¢ÊÇ£ËÄÖ„ÄÅÈ¢ÑÁ∫¶...',
        'Consultations': 'Âí®ËØ¢',
        'Medical Records': 'ÂåªÁñóËÆ∞ÂΩï'
    }
};

const practitionerLanguageNames = {
    'en': 'English',
    'ur': 'ÿßÿ±ÿØŸà',
    'ar': 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©',
    'hi': '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä',
    'es': 'Espa√±ol',
    'fr': 'Fran√ßais',
    'de': 'Deutsch',
    'zh': '‰∏≠Êñá'
};

// Practitioner Dashboard Language Change Function
window.changeDashboardLanguage = function(langCode) {
    try {
        console.log('Changing practitioner dashboard language to:', langCode);
        
        // Update current language display
        const currentLangElement = document.getElementById('dashboard-current-language');
        if (currentLangElement) {
            currentLangElement.textContent = practitionerLanguageNames[langCode];
        }
        
        // Set document direction for RTL languages
        if (langCode === 'ur' || langCode === 'ar') {
            document.documentElement.setAttribute('dir', 'rtl');
            document.documentElement.setAttribute('lang', langCode);
        } else {
            document.documentElement.setAttribute('dir', 'ltr');
            document.documentElement.setAttribute('lang', langCode);
        }
        
        // Store language preference
        localStorage.setItem('selectedLanguage', langCode);
        
        // Translate dashboard content
        translatePractitionerDashboard(langCode);
        
        // Show success message
        showPractitionerLanguageMessage(practitionerLanguageNames[langCode]);
        
        console.log('Practitioner dashboard language changed successfully to:', langCode);
    } catch (error) {
        console.error('Error changing practitioner dashboard language:', error);
    }
};

// Translate Practitioner Dashboard Content
function translatePractitionerDashboard(langCode) {
    try {
        const translation = practitionerTranslations[langCode] || practitionerTranslations['en'];
        
        if (!translation) {
            console.error('No translation found for language:', langCode);
            return;
        }
        
        let translatedCount = 0;
        
        // Translate all elements with data-translate attribute
        document.querySelectorAll('[data-translate]').forEach(element => {
            const key = element.getAttribute('data-translate');
            if (translation[key]) {
                if (element.tagName === 'INPUT' && (element.type === 'text' || element.type === 'search')) {
                    element.placeholder = translation[key];
                } else {
                    element.textContent = translation[key];
                }
                translatedCount++;
            }
        });
        
        console.log(`Practitioner dashboard translation completed: ${translatedCount} elements translated to ${langCode}`);
    } catch (error) {
        console.error('Error in translatePractitionerDashboard:', error);
    }
}

// Show Language Change Message
function showPractitionerLanguageMessage(languageName) {
    const message = document.createElement('div');
    message.className = 'practitioner-language-notification';
    message.innerHTML = `
        <i class="fas fa-check-circle me-2"></i>
        Language changed to ${languageName}
    `;
    message.style.cssText = `
        position: fixed;
        top: 80px;
        right: 30px;
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        z-index: 10002;
        animation: slideInRight 0.3s ease-out;
    `;
    
    document.body.appendChild(message);
    
    setTimeout(() => {
        message.style.animation = 'slideOutRight 0.3s ease-out';
        setTimeout(() => {
            if (document.body.contains(message)) {
                document.body.removeChild(message);
            }
        }, 300);
    }, 3000);
}

// Initialize Practitioner Dashboard Language System
document.addEventListener('DOMContentLoaded', function() {
    try {
        console.log('Initializing practitioner dashboard language system...');
        
        const savedLanguage = localStorage.getItem('selectedLanguage') || 'en';
        console.log('Saved language:', savedLanguage);
        
        // Update current language display
        const currentLangElement = document.getElementById('dashboard-current-language');
        if (currentLangElement) {
            currentLangElement.textContent = practitionerLanguageNames[savedLanguage] || 'English';
        }
        
        // Apply saved language if not English
        if (savedLanguage !== 'en') {
            setTimeout(() => {
                changeDashboardLanguage(savedLanguage);
            }, 100);
        }
        
        console.log('Practitioner dashboard language system initialized successfully');
    } catch (error) {
        console.error('Error initializing practitioner dashboard language system:', error);
    }
});

console.log('üè• Practitioner Dashboard Language System Loaded Successfully!');

// Language Dropdown Functionality
function toggleLanguageDropdown() {
    const dropdown = document.getElementById('languageDropdown');
    const chevron = document.getElementById('languageChevron');
    
    if (dropdown.classList.contains('hidden')) {
        dropdown.classList.remove('hidden');
        chevron.style.transform = 'rotate(180deg)';
    } else {
        dropdown.classList.add('hidden');
        chevron.style.transform = 'rotate(0deg)';
    }
}

// Close dropdown when clicking outside
document.addEventListener('click', function(event) {
    const languageSelector = document.getElementById('languageSelector');
    const languageDropdown = document.getElementById('languageDropdown');
    const chevron = document.getElementById('languageChevron');
    
    if (!languageSelector.contains(event.target)) {
        languageDropdown.classList.add('hidden');
        chevron.style.transform = 'rotate(0deg)';
    }
});

// Enhanced Language Change Function with RTL Support
function changeLanguage(langCode, langName) {
    // Update current language display
    document.getElementById('currentLanguage').textContent = langName;
    
    // Store language preference
    localStorage.setItem('practitionerLanguage', langCode);
    localStorage.setItem('practitionerLanguageName', langName);
    
    // Apply RTL for Arabic and Urdu
    const rtlLanguages = ['ar', 'ur'];
    const htmlElement = document.documentElement;
    
    if (rtlLanguages.includes(langCode)) {
        htmlElement.setAttribute('dir', 'rtl');
        htmlElement.setAttribute('lang', langCode);
        document.body.classList.add('rtl-layout');
    } else {
        htmlElement.setAttribute('dir', 'ltr');
        htmlElement.setAttribute('lang', langCode);
        document.body.classList.remove('rtl-layout');
    }
    
    // Translate all elements with data-translate attribute
    translatePractitionerDashboard(langCode);
    
    // Close dropdown
    document.getElementById('languageDropdown').classList.add('hidden');
    document.getElementById('languageChevron').style.transform = 'rotate(0deg)';
    
    // Show success message
    showLanguageChangeNotification(langName);
}

// Show language change notification
function showLanguageChangeNotification(langName) {
    // Create notification element
    const notification = document.createElement('div');
    notification.className = 'fixed top-4 right-4 bg-doctor-green text-white px-6 py-3 rounded-xl shadow-lg z-50 transform translate-x-full transition-transform duration-300';
    notification.innerHTML = `
        <div class="flex items-center space-x-3">
            <i class="fas fa-check-circle text-lg"></i>
            <span class="font-medium">Language changed to ${langName}</span>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    // Animate in
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    // Animate out and remove
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 300);
    }, 3000);
}

// Load saved language on page load
document.addEventListener('DOMContentLoaded', function() {
    const savedLang = localStorage.getItem('practitionerLanguage');
    const savedLangName = localStorage.getItem('practitionerLanguageName');
    
    if (savedLang && savedLangName) {
        changeLanguage(savedLang, savedLangName);
    }
});

// Alert Bell for Pending Appointments
let pendingAppointmentsData = [];

// Toggle pending appointments dropdown
function togglePendingAppointments() {
    const dropdown = document.getElementById('pendingDropdown');
    
    if (dropdown.classList.contains('hidden')) {
        loadPendingAppointments();
        dropdown.classList.remove('hidden');
    } else {
        dropdown.classList.add('hidden');
    }
}

// Load pending appointments via AJAX
function loadPendingAppointments() {
    fetch('/practitioner-dashboard/api/pending-appointments/')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                pendingAppointmentsData = data.appointments;
                updatePendingAppointmentsList(data.appointments);
                updatePendingCount(data.appointments.length);
            } else {
                console.error('Error loading pending appointments:', data.error);
            }
        })
        .catch(error => {
            console.error('Error fetching pending appointments:', error);
        });
}

// Update pending appointments list in dropdown
function updatePendingAppointmentsList(appointments) {
    const listContainer = document.getElementById('pendingAppointmentsList');
    
    if (appointments.length === 0) {
        listContainer.innerHTML = `
            <div class="p-6 text-center">
                <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-check-circle text-gray-400 text-2xl"></i>
                </div>
                <p class="text-gray-500 text-sm">No pending appointments</p>
            </div>
        `;
        return;
    }
    
    let html = '';
    appointments.forEach(appointment => {
        html += `
            <div class="pending-appointment-item p-4 border-b border-gray-50 hover:bg-gray-50 transition-colors">
                <div class="flex items-start space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-doctor-orange to-orange-600 rounded-full flex items-center justify-center flex-shrink-0">
                        <span class="text-white font-semibold text-sm">${appointment.patient_initial}</span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="font-medium text-doctor-dark-blue text-sm truncate">
                            ${appointment.patient_name}
                        </p>
                        <p class="text-xs text-gray-500 mb-1">${appointment.patient_email}</p>
                        <div class="flex items-center text-xs text-doctor-blue">
                            <i class="fas fa-calendar mr-1"></i>
                            <span>${appointment.date}</span>
                            <i class="fas fa-clock ml-2 mr-1"></i>
                            <span>${appointment.time}</span>
                        </div>
                        <div class="flex items-center justify-between mt-2">
                            <span class="px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs font-medium">
                                Pending
                            </span>
                            <div class="flex space-x-1">
                                <button onclick="quickAcceptAppointment(${appointment.id})" 
                                        class="quick-action-btn px-2 py-1 bg-green-100 text-green-600 rounded text-xs hover:bg-green-200 transition-colors"
                                        title="Accept Appointment">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button onclick="quickCancelAppointment(${appointment.id})" 
                                        class="quick-action-btn px-2 py-1 bg-red-100 text-red-600 rounded text-xs hover:bg-red-200 transition-colors"
                                        title="Cancel Appointment">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    });
    
    listContainer.innerHTML = html;
}

// Update pending count badge
function updatePendingCount(count) {
    const countElement = document.getElementById('pendingCount');
    const bellElement = document.getElementById('alertBell');
    const currentCount = parseInt(countElement.textContent) || 0;
    
    countElement.textContent = count;
    
    if (count > 0) {
        countElement.classList.remove('hidden');
        countElement.classList.add('notification-badge');
        
        // Ring bell if count increased
        if (count > currentCount) {
            bellElement.classList.add('alert-bell-active');
            setTimeout(() => {
                bellElement.classList.remove('alert-bell-active');
            }, 500);
        }
    } else {
        countElement.classList.add('hidden');
    }
}

// Quick accept appointment from alert bell
function quickAcceptAppointment(appointmentId) {
    if (confirm('Are you sure you want to accept this appointment?')) {
        fetch(`/practitioner-dashboard/appointments/${appointmentId}/Accepted/`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Appointment accepted successfully!', 'success');
                    loadPendingAppointments(); // Refresh the list
                } else {
                    showNotification('Error accepting appointment', 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('Error accepting appointment', 'error');
            });
    }
}

// Quick cancel appointment from alert bell
function quickCancelAppointment(appointmentId) {
    if (confirm('Are you sure you want to cancel this appointment?')) {
        fetch(`/practitioner-dashboard/appointments/${appointmentId}/Cancelled/`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Appointment cancelled successfully!', 'success');
                    loadPendingAppointments(); // Refresh the list
                } else {
                    showNotification('Error cancelling appointment', 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('Error cancelling appointment', 'error');
            });
    }
}

// Show notification message
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
    
    notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-xl shadow-lg z-50 transform translate-x-full transition-transform duration-300`;
    notification.innerHTML = `
        <div class="flex items-center space-x-3">
            <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} text-lg"></i>
            <span class="font-medium">${message}</span>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    // Animate in
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    // Animate out and remove
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (document.body.contains(notification)) {
                document.body.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

// Close dropdown when clicking outside
document.addEventListener('click', function(event) {
    const alertBell = document.getElementById('alertBell');
    const pendingDropdown = document.getElementById('pendingDropdown');
    
    if (!alertBell.contains(event.target) && !pendingDropdown.contains(event.target)) {
        pendingDropdown.classList.add('hidden');
    }
});

// Load pending appointments on page load
document.addEventListener('DOMContentLoaded', function() {
    loadPendingAppointments();
    
    // Refresh pending appointments every 30 seconds
    setInterval(loadPendingAppointments, 30000);
});

// Mobile Sidebar Toggle Function
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebar-overlay');
    
    if (sidebar.classList.contains('-translate-x-full')) {
        // Show sidebar
        sidebar.classList.remove('-translate-x-full');
        sidebar.classList.add('translate-x-0');
        overlay.classList.remove('hidden');
    } else {
        // Hide sidebar
        sidebar.classList.add('-translate-x-full');
        sidebar.classList.remove('translate-x-0');
        overlay.classList.add('hidden');
    }
}

// Close sidebar when clicking outside on mobile
document.addEventListener('click', function(event) {
    const sidebar = document.getElementById('sidebar');
    const mobileMenuBtn = document.querySelector('[onclick="toggleSidebar()"]');
    const overlay = document.getElementById('sidebar-overlay');
    
    // Check if click is outside sidebar and not on menu button
    if (window.innerWidth < 1024 && 
        !sidebar.contains(event.target) && 
        !mobileMenuBtn.contains(event.target) &&
        !sidebar.classList.contains('-translate-x-full')) {
        
        sidebar.classList.add('-translate-x-full');
        sidebar.classList.remove('translate-x-0');
        overlay.classList.add('hidden');
    }
});

// Handle window resize
window.addEventListener('resize', function() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebar-overlay');
    
    if (window.innerWidth >= 1024) {
        // Desktop view - ensure sidebar is visible and overlay is hidden
        sidebar.classList.remove('-translate-x-full');
        sidebar.classList.add('translate-x-0');
        overlay.classList.add('hidden');
    } else {
        // Mobile view - ensure sidebar is hidden by default
        sidebar.classList.add('-translate-x-full');
        sidebar.classList.remove('translate-x-0');
        overlay.classList.add('hidden');
    }
});
</script>

</body>

</html>