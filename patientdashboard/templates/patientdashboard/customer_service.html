{% extends 'patientdashboard/patient_base.html' %}
{% load static %}

{% block title %}Customer Service - Patient Dashboard{% endblock %}

{% block content %}
<!-- Modern Customer Service Header -->
<div class="bg-gradient-to-r from-blue-600 to-blue-800 rounded-2xl p-6 mb-8 text-white">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
        <div>
            <h1 class="text-2xl md:text-3xl font-bold mb-2" data-translate="Customer Service">Service Client</h1>
            <p class="text-white/90" data-translate="We're here to help you with any questions or concerns">Nous sommes là pour vous aider avec toutes vos questions ou préoccupations</p>
        </div>
        <div class="mt-4 md:mt-0 flex gap-3">
            <div class="flex items-center space-x-2 bg-white/20 rounded-lg px-4 py-2">
                <i class="fas fa-clock text-green-300"></i>
                <span class="text-sm" data-translate="Available 24/7">Disponible 24h/24 7j/7</span>
            </div>
        </div>
    </div>
</div>

<!-- Quick Contact Options -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center">
                <i class="fas fa-phone text-white text-lg"></i>
            </div>
            <span class="px-3 py-1 bg-green-100 text-green-600 rounded-full text-sm font-medium" data-translate="Immediate">Immédiat</span>
        </div>
        <h3 class="text-lg font-bold text-gray-800 mb-2" data-translate="Phone Support">Support Téléphonique</h3>
        <p class="text-gray-600 text-sm mb-4" data-translate="Speak directly with our support team">Parlez directement avec notre équipe de support</p>
        <div class="space-y-2">
            <div class="flex items-center text-sm text-gray-700">
                <i class="fas fa-phone-alt mr-2 text-green-500"></i>
                <span>+33 1 23 45 67 89</span>
            </div>
            <div class="flex items-center text-sm text-gray-700">
                <i class="fas fa-clock mr-2 text-green-500"></i>
                <span data-translate="24/7 Available">Disponible 24h/24</span>
            </div>
        </div>
        <button onclick="initiatePhoneCall()" class="w-full mt-4 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition-colors">
            <i class="fas fa-phone mr-2"></i><span data-translate="Call Now">Appeler Maintenant</span>
        </button>
    </div>

    <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center">
                <i class="fas fa-comments text-white text-lg"></i>
            </div>
            <span class="px-3 py-1 bg-blue-100 text-blue-600 rounded-full text-sm font-medium" data-translate="Fast">Rapide</span>
        </div>
        <h3 class="text-lg font-bold text-gray-800 mb-2" data-translate="Live Chat">Chat en Direct</h3>
        <p class="text-gray-600 text-sm mb-4" data-translate="Get instant help through our chat system">Obtenez de l'aide instantanée via notre système de chat</p>
        <div class="space-y-2">
            <div class="flex items-center text-sm text-gray-700">
                <i class="fas fa-user-headset mr-2 text-blue-500"></i>
                <span data-translate="Live Agents">Agents en Direct</span>
            </div>
            <div class="flex items-center text-sm text-gray-700">
                <i class="fas fa-language mr-2 text-blue-500"></i>
                <span data-translate="French & English">Français & Anglais</span>
            </div>
        </div>
        <button onclick="openLiveChat()" class="w-full mt-4 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors">
            <i class="fas fa-comments mr-2"></i><span data-translate="Start Chat">Démarrer le Chat</span>
        </button>
    </div>

    <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center">
                <i class="fas fa-envelope text-white text-lg"></i>
            </div>
            <span class="px-3 py-1 bg-purple-100 text-purple-600 rounded-full text-sm font-medium" data-translate="Detailed">Détaillé</span>
        </div>
        <h3 class="text-lg font-bold text-gray-800 mb-2" data-translate="Email Support">Support Email</h3>
        <p class="text-gray-600 text-sm mb-4" data-translate="Send us detailed questions or feedback">Envoyez-nous des questions détaillées ou des commentaires</p>
        <div class="space-y-2">
            <div class="flex items-center text-sm text-gray-700">
                <i class="fas fa-envelope mr-2 text-purple-500"></i>
                <span>support@reeduvi.com</span>
            </div>
            <div class="flex items-center text-sm text-gray-700">
                <i class="fas fa-reply mr-2 text-purple-500"></i>
                <span data-translate="Response within 2h">Réponse sous 2h</span>
            </div>
        </div>
        <button onclick="openEmailForm()" class="w-full mt-4 bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition-colors">
            <i class="fas fa-envelope mr-2"></i><span data-translate="Send Email">Envoyer un Email</span>
        </button>
    </div>
</div>

<!-- Support Categories -->
<div class="bg-white rounded-2xl shadow-lg border border-gray-100 mb-8">
    <div class="p-6 border-b border-gray-200">
        <h2 class="text-xl font-bold text-gray-800" data-translate="How can we help you?">Comment pouvons-nous vous aider ?</h2>
        <p class="text-gray-600 mt-1" data-translate="Choose a category for faster assistance">Choisissez une catégorie pour une assistance plus rapide</p>
    </div>
    <div class="p-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <button onclick="openSupportCategory('appointments')" class="text-left p-4 border border-gray-200 rounded-xl hover:border-blue-300 hover:bg-blue-50 transition-all duration-300">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-calendar-alt text-blue-600"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800" data-translate="Appointments">Rendez-vous</h3>
                        <p class="text-sm text-gray-600" data-translate="Booking, cancellation, rescheduling">Réservation, annulation, reprogrammation</p>
                    </div>
                </div>
            </button>

            <button onclick="openSupportCategory('payments')" class="text-left p-4 border border-gray-200 rounded-xl hover:border-green-300 hover:bg-green-50 transition-all duration-300">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-credit-card text-green-600"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800" data-translate="Payments">Paiements</h3>
                        <p class="text-sm text-gray-600" data-translate="Billing, insurance, refunds">Facturation, assurance, remboursements</p>
                    </div>
                </div>
            </button>

            <button onclick="openSupportCategory('technical')" class="text-left p-4 border border-gray-200 rounded-xl hover:border-purple-300 hover:bg-purple-50 transition-all duration-300">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-cog text-purple-600"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800" data-translate="Technical Issues">Problèmes Techniques</h3>
                        <p class="text-sm text-gray-600" data-translate="App problems, video calls, login">Problèmes d'app, appels vidéo, connexion</p>
                    </div>
                </div>
            </button>

            <button onclick="openSupportCategory('medical')" class="text-left p-4 border border-gray-200 rounded-xl hover:border-red-300 hover:bg-red-50 transition-all duration-300">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-stethoscope text-red-600"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800" data-translate="Medical Questions">Questions Médicales</h3>
                        <p class="text-sm text-gray-600" data-translate="Health concerns, prescriptions">Préoccupations de santé, ordonnances</p>
                    </div>
                </div>
            </button>

            <button onclick="openSupportCategory('account')" class="text-left p-4 border border-gray-200 rounded-xl hover:border-yellow-300 hover:bg-yellow-50 transition-all duration-300">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-user text-yellow-600"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800" data-translate="Account Management">Gestion de Compte</h3>
                        <p class="text-sm text-gray-600" data-translate="Profile, settings, privacy">Profil, paramètres, confidentialité</p>
                    </div>
                </div>
            </button>

            <button onclick="openSupportCategory('feedback')" class="text-left p-4 border border-gray-200 rounded-xl hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-300">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-star text-indigo-600"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800" data-translate="Feedback & Suggestions">Commentaires & Suggestions</h3>
                        <p class="text-sm text-gray-600" data-translate="Share your experience">Partagez votre expérience</p>
                    </div>
                </div>
            </button>
        </div>
    </div>
</div>

<!-- FAQ Section -->
<div class="bg-white rounded-2xl shadow-lg border border-gray-100 mb-8">
    <div class="p-6 border-b border-gray-200">
        <h2 class="text-xl font-bold text-gray-800" data-translate="Frequently Asked Questions">Questions Fréquemment Posées</h2>
        <p class="text-gray-600 mt-1" data-translate="Find quick answers to common questions">Trouvez des réponses rapides aux questions courantes</p>
    </div>
    <div class="p-6">
        <div class="space-y-4">
            <div class="border border-gray-200 rounded-lg">
                <button onclick="toggleFAQ('faq1')" class="w-full text-left p-4 flex justify-between items-center hover:bg-gray-50">
                    <span class="font-medium text-gray-800" data-translate="How do I book an appointment?">Comment réserver un rendez-vous ?</span>
                    <i class="fas fa-chevron-down text-gray-400 transform transition-transform" id="faq1-icon"></i>
                </button>
                <div id="faq1" class="hidden p-4 border-t border-gray-200 bg-gray-50">
                    <p class="text-gray-600" data-translate="To book an appointment, go to 'Book Appointment' from your dashboard, select a specialty, choose a practitioner, and pick an available time slot.">Pour réserver un rendez-vous, allez dans "Réserver un rendez-vous" depuis votre tableau de bord, sélectionnez une spécialité, choisissez un praticien et choisissez un créneau horaire disponible.</p>
                </div>
            </div>

            <div class="border border-gray-200 rounded-lg">
                <button onclick="toggleFAQ('faq2')" class="w-full text-left p-4 flex justify-between items-center hover:bg-gray-50">
                    <span class="font-medium text-gray-800" data-translate="Can I cancel my appointment?">Puis-je annuler mon rendez-vous ?</span>
                    <i class="fas fa-chevron-down text-gray-400 transform transition-transform" id="faq2-icon"></i>
                </button>
                <div id="faq2" class="hidden p-4 border-t border-gray-200 bg-gray-50">
                    <p class="text-gray-600" data-translate="Yes, you can cancel your appointment from the 'My Appointments' section. Please provide a reason for cancellation to help us improve our services.">Oui, vous pouvez annuler votre rendez-vous depuis la section "Mes rendez-vous". Veuillez fournir une raison d'annulation pour nous aider à améliorer nos services.</p>
                </div>
            </div>

            <div class="border border-gray-200 rounded-lg">
                <button onclick="toggleFAQ('faq3')" class="w-full text-left p-4 flex justify-between items-center hover:bg-gray-50">
                    <span class="font-medium text-gray-800" data-translate="How do video consultations work?">Comment fonctionnent les consultations vidéo ?</span>
                    <i class="fas fa-chevron-down text-gray-400 transform transition-transform" id="faq3-icon"></i>
                </button>
                <div id="faq3" class="hidden p-4 border-t border-gray-200 bg-gray-50">
                    <p class="text-gray-600" data-translate="Once your appointment is confirmed, you'll receive a video call link. Click 'Join Call' at your appointment time to connect with your practitioner via Zoom.">Une fois votre rendez-vous confirmé, vous recevrez un lien d'appel vidéo. Cliquez sur "Rejoindre l'appel" à l'heure de votre rendez-vous pour vous connecter avec votre praticien via Zoom.</p>
                </div>
            </div>

            <div class="border border-gray-200 rounded-lg">
                <button onclick="toggleFAQ('faq4')" class="w-full text-left p-4 flex justify-between items-center hover:bg-gray-50">
                    <span class="font-medium text-gray-800" data-translate="What payment methods do you accept?">Quels modes de paiement acceptez-vous ?</span>
                    <i class="fas fa-chevron-down text-gray-400 transform transition-transform" id="faq4-icon"></i>
                </button>
                <div id="faq4" class="hidden p-4 border-t border-gray-200 bg-gray-50">
                    <p class="text-gray-600" data-translate="We accept credit cards, debit cards, and social security payments. All payments are processed securely through our encrypted payment system.">Nous acceptons les cartes de crédit, les cartes de débit et les paiements de sécurité sociale. Tous les paiements sont traités de manière sécurisée via notre système de paiement crypté.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Contact Form Modal -->
<div class="fixed inset-0 bg-black/50 z-50 hidden" id="contactModal">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-800" data-translate="Contact Customer Service">Contacter le Service Client</h3>
                    <button type="button" onclick="closeContactModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            <form method="post" action="{% url 'patient_dashboard:submit_support_request' %}">
                {% csrf_token %}
                <div class="p-6 space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="Category">Catégorie</label>
                        <select name="category" id="supportCategory" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500" required>
                            <option value="" data-translate="Select a category">Sélectionnez une catégorie</option>
                            <option value="appointments" data-translate="Appointments">Rendez-vous</option>
                            <option value="payments" data-translate="Payments">Paiements</option>
                            <option value="technical" data-translate="Technical Issues">Problèmes Techniques</option>
                            <option value="medical" data-translate="Medical Questions">Questions Médicales</option>
                            <option value="account" data-translate="Account Management">Gestion de Compte</option>
                            <option value="feedback" data-translate="Feedback & Suggestions">Commentaires & Suggestions</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="Priority">Priorité</label>
                        <select name="priority" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500" required>
                            <option value="low" data-translate="Low - General inquiry">Faible - Demande générale</option>
                            <option value="medium" data-translate="Medium - Need assistance">Moyenne - Besoin d'assistance</option>
                            <option value="high" data-translate="High - Urgent issue">Élevée - Problème urgent</option>
                            <option value="critical" data-translate="Critical - Emergency">Critique - Urgence</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="Subject">Sujet</label>
                        <input type="text" name="subject" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500" placeholder="Brief description of your issue" required>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="Message">Message</label>
                        <textarea name="message" rows="6" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 resize-none" placeholder="Please describe your issue in detail..." required></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="Preferred Contact Method">Méthode de Contact Préférée</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="contact_method" value="email" class="mr-3 text-blue-600" checked>
                                <span data-translate="Email">Email</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="contact_method" value="phone" class="mr-3 text-blue-600">
                                <span data-translate="Phone">Téléphone</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="contact_method" value="chat" class="mr-3 text-blue-600">
                                <span data-translate="Live Chat">Chat en Direct</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="p-6 border-t border-gray-200 flex justify-end space-x-4">
                    <button type="button" onclick="closeContactModal()" class="px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors">
                        <span data-translate="Cancel">Annuler</span>
                    </button>
                    <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors">
                        <i class="fas fa-paper-plane mr-2"></i><span data-translate="Send Request">Envoyer la Demande</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
// Phone call function
function initiatePhoneCall() {
    if (confirm('Voulez-vous appeler le support maintenant ?\n+33 1 23 45 67 89')) {
        window.location.href = 'tel:+33123456789';
    }
}

// Live chat function
function openLiveChat() {
    // This would integrate with a live chat service like Intercom, Zendesk, etc.
    showNotification('Connexion au chat en direct...', 'info');
    // For demo purposes, open contact form
    setTimeout(() => {
        openEmailForm();
    }, 1000);
}

// Email form function
function openEmailForm() {
    document.getElementById('contactModal').classList.remove('hidden');
}

// Close contact modal
function closeContactModal() {
    document.getElementById('contactModal').classList.add('hidden');
}

// Support category function
function openSupportCategory(category) {
    document.getElementById('supportCategory').value = category;
    openEmailForm();
}

// FAQ toggle function
function toggleFAQ(faqId) {
    const faqContent = document.getElementById(faqId);
    const faqIcon = document.getElementById(faqId + '-icon');
    
    if (faqContent.classList.contains('hidden')) {
        faqContent.classList.remove('hidden');
        faqIcon.style.transform = 'rotate(180deg)';
    } else {
        faqContent.classList.add('hidden');
        faqIcon.style.transform = 'rotate(0deg)';
    }
}

// Notification function
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
    
    notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-xl shadow-lg z-50 transform translate-x-full transition-transform duration-300`;
    notification.innerHTML = `
        <div class="flex items-center space-x-3">
            <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} text-lg"></i>
            <span class="font-medium">${message}</span>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    // Animate in
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    // Animate out and remove
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (document.body.contains(notification)) {
                document.body.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

// Close modal when clicking outside
document.getElementById('contactModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeContactModal();
    }
});
</script>
{% endblock %}